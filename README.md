# cpro2020

京都大学の授業「電気電子プログラミング及演習」の2020年度授業において作成した課題及び手書き文字認識です。C言語で記述しています。

## final.c

手書き文字認識のコードです。学習モードと推論モードがあります。

## 学習モード

コマンドライン引数に任意の３つの.datファイルを指定することで，学習モードで実行することができます。この３つのファイルに学習後の重みパラメータの値が格納されます。

```
/final.exe fc1.dat fc2.dat fc3.dat
```

実行後は次のオプションがあります。

```
Select the parameter initialization method
If you want to select rand_init: 1
If you want to select Gaussian_init: 2
```

パラメータの初期化について２つの方法を実装しています。１を入力すると，[-1:1]のランダムな値での初期化，２を入力するとガウス分布での初期化がなされます。

次に最適化の手法の選択のオプションが表示されます。

```
Select optimization mode
If you want to select SGD: 1
If you want to select Momentum: 2
If you want to select AdaGrad: 3
Caution! Momentum doesn't work well
```

１を選択するとSGDでの最適化，２を選択するとMomentumでの最適化，３を選択するとAdaGradでの最適化がなされます。ただし，Momentumは上手く実装できていません。

実装後は学習がなされます。学習終了後にコマンドライン引数で指定したファイルに学習後の重みパラメータの値が格納されます。毎エポックごとに進行率と訓練データ，テストデータに対する正確率と損失関数の値を表示しています。

```
-----------------------------------------------------------------------
Epoch 1/8

 0% complete...........................................................
10% complete...........................................................
20% complete...........................................................
30% complete...........................................................
40% complete...........................................................
50% complete...........................................................
60% complete...........................................................
70% complete...........................................................
80% complete...........................................................
90% complete...........................................................

Train Accuracy : 94.731667 %
Train Loss Func Average: 0.181976

Test Accuracy: 94.000000 %
Test Loss Func Average: 0.184307
```



## 推論モード

コマンドライン引数に４つの引数を指定することで，推論モードで実行することができます。先の３つは学習した３つの.datファイル，４つ目は推論する画像のデータを指定します。

```
\final.exe fc1.dat fc2.dat fc3.dat train_00000.bmp
The number is 5
Accuracy rate is 99.902687%
```

